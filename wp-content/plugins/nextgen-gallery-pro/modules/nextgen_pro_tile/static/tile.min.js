!function(e){function i(){this.galleries=[],this.findAndSetupNewGalleries()}function t(e){this.gallery=e,this.resize(),this.gallery.removeClass("tiled-gallery-unresized")}i.prototype.findAndSetupNewGalleries=function(){var i=this;e(".tiled-gallery.tiled-gallery-unresized").each((function(){i.galleries.push(new t(e(this)))}))},i.prototype.resizeAll=function(){e.each(this.galleries,(function(e,i){i.resize()}))},t.prototype.resizeableElementsSelector=".gallery-row, .gallery-group, .tiled-gallery-item img",t.prototype.getExtraDimension=function(e,i,t){if("horizontal"===t){var r="border"===i?"borderLeftWidth":i+"Left",n="border"===i?"borderRightWidth":i+"Right";return(parseInt(e.css(r),10)||0)+(parseInt(e.css(n),10)||0)}if("vertical"===t){var o="border"===i?"borderTopWidth":i+"Top",a="border"===i?"borderBottomWidth":i+"Bottom";return(parseInt(e.css(o),10)||0)+(parseInt(e.css(a),10)||0)}return 0},t.prototype.resize=function(){var i=this.gallery.data("original-width"),t=this.gallery.parent().width(),r=Math.min(1,t/i),n=this;this.gallery.find(this.resizeableElementsSelector).each((function(){var i=e(this),t=n.getExtraDimension(i,"margin","horizontal"),o=n.getExtraDimension(i,"margin","vertical"),a=n.getExtraDimension(i,"padding","horizontal"),l=n.getExtraDimension(i,"padding","vertical"),s=n.getExtraDimension(i,"border","horizontal"),d=n.getExtraDimension(i,"border","vertical"),h=i.data("original-width")+a+s+t,u=i.data("original-height")+l+d+o;i.width(Math.floor(r*h)-t).height(Math.floor(r*u)-o)}))};var r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;e(document).ready((function(){var t=new i;e("body").on("post-load",(function(e,i){"string"==typeof i&&"resize"===i?t.resizeAll():t.findAndSetupNewGalleries()})),window.chrome&&r?function(i){var t=!1,n=null;function o(){i.resizeAll(),t&&r(o)}e(window).on("resize",(function(){clearTimeout(n),t||r(o),t=!0,n=setTimeout((function(){t=!1}),15)}))}(t):function(i){e(window).resize((function(){i.resizeAll()}))}(t)}))}(jQuery);