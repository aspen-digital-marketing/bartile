!function(e){"use strict";var t=new function(){var t={debug:!1,debug_level:1,state:{slug:null,gallery_id:null,image_id:null,sidebar:null},selector:nextgen_lightbox_filter_selector(e,e(".nextgen_pro_lightbox")),options:{},defaults:{speed:"medium",initial_url:window.location.toString().split("#")[0],ajax_url:photocrati_ajax.url,router_slug:"gallery"},init:function(i){t.methods.log("nplModal.init()",{parameters:i,defaults:t.defaults,selector:t.selector,debug:t.debug,debug_level:t.debug_level});var n=e("<div id='npl_overlay'></div>"),a=e("<div id='npl_wrapper'></div>"),o=e("<div id='npl_spinner_container' class='npl-loading-spinner hidden'><i id='npl_spinner' class='fa fa-spin fa-spinner'></i></div>"),s=e("<div id='npl_button_close' class='hidden'><i class='fa fa-times'></i></div>"),l=e("<div id='npl_content'></div>"),r=e("<div id='npl_sidebar'></div>"),d=e("<div id='npl_sidebar_overlay'><i class='fa fa-spin fa-spinner'/></div>"),g=e("<i   id='npl_sidebar_toggle' class='fa fa-arrow-right'/>");t.methods.mobile.browser.ios()&&(n.addClass("npl_ios_no_opacity"),a.addClass("npl_ios_hack")),t.methods.is_ie9()&&a.addClass("npl_ie9_flex_hack"),e(window).trigger("override_nplModal_methods",t.methods),n.css({background:t.methods.get_setting("background_color")}),o.css({color:t.methods.get_setting("icon_color")}),d.css({color:t.methods.get_setting("icon_color")}),s.css({color:t.methods.get_setting("overlay_icon_color")}),r.css({background:t.methods.get_setting("sidebar_background_color")}),g.css({color:t.methods.get_setting("overlay_icon_color")});var _=e("body");if(_.append(n),_.append(a),a.append(o),a.append(s),a.append(g),a.append(l),a.append(r),a.append(d),i=e.extend(i,{router_slug:t.methods.get_setting("router_slug")}),t.options=e.extend(t.defaults,i),t.methods.bind_images(),t.methods.set_events(),t.methods.mobile.init(),parseInt(t.methods.get_setting("padding","0"))>0){var h=t.methods.get_setting("padding","0"),c=t.methods.get_setting("padding_unit","px"),m=window.innerWidth/4,p=window.innerHeight/4,u=Math.min(m,p);"px"===c&&h>u?h=u:"%"===c&&h>25&&(h=25),e("<style type='text/css'>#npl_wrapper.npl_open_with_padding {top: "+(h+=c)+";bottom: "+h+";left: "+h+";right: "+h+"; } </style>").appendTo("head")}t.methods.router.routes.push({re:new RegExp("^"+t.options.router_slug+"/(.*)/(.*)/(.*)$","i"),handler:t.methods.url_handler}),t.methods.router.routes.push({re:new RegExp("^"+t.options.router_slug+"/(.*)/(.*)$","i"),handler:t.methods.url_handler}),t.methods.router.routes.push({re:new RegExp("^"+t.options.router_slug+"$","i"),handler:t.methods.close_modal}),t.methods.router.routes.push({re:"",handler:t.methods.close_modal}),["load","pageshow"].map((function(e){setTimeout((function(){t.methods.router.listen()}),200)})),(t.methods.mobile.browser.ios()||t.methods.mobile.browser.android())&&a.addClass("npl_mobile"),e(window).trigger("npl_initialization_complete")},methods:{_pre_open_callbacks:[],_is_open:!1,getDPIRatio:function(){var e=1;return void 0!==window.screen.systemXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.systemXDPI>window.screen.logicalXDPI?e=window.screen.systemXDPI/window.screen.logicalXDPI:void 0!==window.devicePixelRatio&&(e=window.devicePixelRatio),t.methods.log("nplModal.getDPIRatio()",{result:e}),e},url_handler:function(){var i=arguments[0],n=arguments[1],a=null;3===arguments.length&&"1"===(a=arguments[2])&&(a="comments");var o=this.get_id_from_slug(i);o||(o=i);var s=this.get_state();parseInt(n)===s.image_id&&(n=parseInt(n));var l={gallery_id:o,image_id:n,sidebar:a,slug:i};this.set_state(l),e("#npl_content").trigger("npl_url_handler",[l]),this.is_open()&&o===t.state.gallery_id||this.open_modal(o,n,a)},run_pre_open_lightbox_callbacks:function(e,t){for(var i=0;i<this._pre_open_callbacks.length;i++){t=(0,this._pre_open_callbacks[i])(e,t)}return t},add_pre_open_callback:function(e){this._pre_open_callbacks.push(e)},get_state:function(){return t.state},set_state:function(e){t.methods.log("nplModal.set_state()",{state:e}),t.state=e},get_setting:function(e,i){var n="";return 1===(n="undefined"!=typeof nplModalSettings&&void 0!==nplModalSettings[e]&&""!==nplModalSettings[e]?window.nplModalSettings[e]:i)&&(n=!0),0===n&&(n=!1),"1"===n&&(n=!0),"0"===n&&(n=!1),t.methods.log("nplModal.get_setting()",{name:e,result:n},3),n},get_slug:function(i){var n=i;return void 0===window.galleries||(e.each(galleries,(function(e,t){t.slug&&t.ID===i&&(n=t.slug)})),t.methods.log("nplModal.get_slug()",{gallery_id:i,result:n})),n},open:function(e){t.methods.log("nplModal.open()",{el:e});var i={show_sidebar:"",gallery_id:"!",image_id:"!",slug:null,revert_image_id:"!",open_the_lightbox:!0};if(e.data("nplmodal-show-comments")&&(i.show_sidebar="/comments"),e.data("nplmodal-gallery-id")&&(i.gallery_id=e.data("nplmodal-gallery-id")),e.data("nplmodal-image-id"))i.image_id=parseInt(e.data("nplmodal-image-id"));else if(e.data("image-id"))i.image_id=parseInt(e.data("image-id"));else if("!"===i.gallery_id){var n=e.find("img");if(i.image_id=n.attr("src"),n.attr("srcset")){var a=parseSrcset(n.attr("srcset")),o=0;_.each(a,(function(e){void 0!==typeof e.w&&e.w>o&&(o=e.w,i.image_id=e.url)}))}}"!"!==i.gallery_id&&(i.slug=this.get_slug(i.gallery_id)),(i=this.run_pre_open_lightbox_callbacks(e,i)).open_the_lightbox&&("!"!==i.gallery_id&&this.get_setting("enable_routing")?(t.methods.router.front_page_pushstate(i.gallery_id,i.image_id),t.methods.set_state({gallery_id:i.gallery_id,image_id:i.image_id,sidebar:i.show_sidebar,slug:i.slug}),this.router.navigate(t.options.router_slug+"/"+i.slug+"/"+i.image_id+i.show_sidebar),"!"!==i.revert_image_id&&(t.state.image_id=i.revert_image_id)):this.open_modal(i.gallery_id,i.image_id,null))},bind_images:function(){for(var i=nextgen_lightbox_filter_selector(e,e(".nextgen_pro_lightbox")),n=[],a=0;a<i.length;a++){var o=i[a];e(o).hasClass("photocrati_lightbox_always")||e(o).hasClass("decoy")||n.push(o)}n=n.map((function(t){return e(t).hasClass("nextgen_pro_lightbox")&&"A"!=t.nodeName&&e(t).parents("a").length?e(t).parents("a")[0]:t})),t.selector=e(n),t.selector.on("click",(function(i){e.inArray(e(this).attr("target"),["_blank","_parent","_top"])>-1||e(this).data("src")&&-1!==e(this).data("src").indexOf(t.methods.get_setting("router_slug")+"/image")&&!e(this).data("nplmodal-gallery-id")||(i.stopPropagation(),i.preventDefault(),!0!==i.handled&&(i.handled=!0,t.methods.open(e(this))))}))},set_events:function(){var t=this;e(window).on("refreshed",t.bind_images),e(window).on("keydown",t.handle_keyboard_input),e("#npl_content").on("npl_images_ready",t.open_modal_final),e("#npl_overlay, #npl_button_close").on("touchstart click",(function(e){e.stopPropagation(),e.preventDefault(),!0!==e.handled&&(e.handled=!0,t.close_modal())}))},open_modal:function(i,n,a){t.methods.log("nplModal.open_modal()",{gallery_id:i,image_id:n,sidebar:a}),this._is_open=!0,e("#npl_content").trigger("npl_opening"),e("html, body").toggleClass("nextgen_pro_lightbox_open"),t.state.image_id=n,t.state.gallery_id=i,e("#npl_spinner_container").removeClass("hidden"),e("#npl_button_close").removeClass("hidden"),this.fullsize.exit(),this.mobile.open(),t.methods.fetch_images.fetch_images(i,n)},preload_image:function(e){return new Promise(t=>{const i=new Image;i.addEventListener("load",()=>{t()}),i.src=e.use_hdpi?e.srcsets.hdpi:e.image})},open_modal_final:function(i,n){var a=0,o=t.methods.getDPIRatio()>1,s=t.methods.fetch_images.gallery_image_cache[t.state.gallery_id],l=t.state.sidebar;e.each(s,(function(e,i){parseInt(t.state.image_id)===parseInt(i.image_id)&&(a=e),"string"==typeof t.state.image_id&&"string"==typeof i.image_id&&t.state.image_id===i.image_id&&(a=e),void 0!==i.full_use_hdpi&&(o&&i.full_use_hdpi?i.image=i.full_srcsets.hdpi:i.image=i.full_image)}));var r=t.methods.get_setting("enable_carousel","always"),d=t.methods.get_setting("carousel_thumbnails_limit",250),g=t.methods.get_gallery_from_id(n);"always"===r?r="lazy":"never"===r?r=!1:"nomobile"===r&&(r=!t.methods.mobile.browser.any()&&"lazy"),g&&g.images_list_count>=d&&(r=!1),r||e("#npl_wrapper").addClass("nggpl-carousel-hidden"),(l||t.methods.get_setting("display_cart",!1)&&t.methods.get_displayed_gallery_setting(n,"is_ecommerce_enabled",!1)||t.methods.get_setting("display_comments",!1)&&t.methods.get_setting("enable_comments",!1))&&e("#npl_wrapper").addClass("npl-sidebar-open npl-sidebar-overlay-open"),t.methods.get_setting("display_captions",!1)&&e("#npl_wrapper").addClass("npl-info-open"),t.methods.get_setting("style")&&e("#npl_wrapper").addClass("npl-variant-"+t.methods.get_setting("style")),t.methods.get_setting("display_carousel",!0)&&!t.methods.mobile.browser.any()||e("#npl_wrapper").addClass("npl-carousel-closed"),s.length>=d&&(r=!1),t.methods.log("nplModal.open_modal() about to invoke Galleria.run()",{thumbnails:r,images:s,show:a,sidebar:l});const _=s.slice(a-3,a+3).map(e=>t.methods.preload_image(e));Promise.all(_).then(i=>{Galleria.run("#npl_content",{responsive:!0,thumbQuality:!1,thumbnails:r,preload:0,theme:"nextgen_pro_lightbox",dataSource:s,show:a,variation:"nggpl-variant-"+t.methods.get_setting("style",""),transition:t.methods.get_setting("transition_effect","slide"),touchTransition:t.methods.get_setting("touch_transition_effect","slide"),imagePan:t.methods.get_setting("image_pan",!1),pauseOnInteraction:t.methods.get_setting("interaction_pause",!0),imageCrop:t.methods.get_setting("image_crop",!0),transitionSpeed:1e3*t.methods.get_setting("transition_speed",.4),nggSidebar:l}),e("#npl_content .galleria-container").css({background:t.methods.get_setting("background_color")})})},mobile:{meta:null,original:null,adjust:!0,ontouch:"ontouchstart"in window,init:function(){this.ontouch||(this.adjust=!1);var e=window.document;e.querySelector&&(this.meta=e.querySelector("meta[name=viewport]"),this.original=this.meta&&this.meta.getAttribute("content"))},open:function(){this.adjust&&this.meta&&(t.methods.log("nplModal.mobile.open()"),this.meta.setAttribute("content",this.original+", width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=0, shrink-to-fit=no"))},close:function(){this.adjust&&this.meta&&(t.methods.log("nplModal.mobile.close()"),this.meta.setAttribute("content",this.original))},browser:{any:function(){return t.methods.mobile.browser.android()||t.methods.mobile.browser.ios()||t.methods.mobile.browser.windowsphone()||t.methods.mobile.browser.blackberry()},android:function(){return/Android/i.test(navigator.userAgent)},ios:function(){return/crios|iP(hone|od|ad)/i.test(navigator.userAgent)},windowsphone:function(){return/(iemobile|Windows Phone)/i.test(navigator.userAgent)},blackberry:function(){return/(blackberry|RIM Tablet|BB10; )/i.test(navigator.userAgent)}}},is_ie9:function(){return-1!==navigator.appVersion.indexOf("MSIE 9.")},close_modal:function(){if(!this._is_open)return;t.methods.log("nplModal.close_modal()");var i=e("#npl_content");i.trigger("npl_closing");const n=i.data("galleria");void 0!==n&&n.destroy(),this.fullsize.enter(),e("#npl_spinner_container, #npl_button_close").addClass("hidden"),e("html, body").toggleClass("nextgen_pro_lightbox_open"),e("#npl_wrapper").removeClass(),this.mobile.close(),this.get_setting("enable_routing")&&(history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):window.location.hash="",this.get_setting("is_front_page")&&history.pushState&&history.pushState({},document.title,t.options.initial_url)),this._is_open=!1},fullsize:{_is_fullsize:!1,active:function(){return this.fullsize._is_fullsize},enter:function(){t.methods.log("nplModal.fullsize.enter()"),e("#npl_wrapper").removeClass("npl_open_with_padding"),this._is_fullsize=!0},exit:function(){t.methods.log("nplModal.fullsize.exit()"),parseInt(t.methods.get_setting("padding","0"))>0&&!t.methods.mobile.browser.ios()&&e("#npl_wrapper").addClass("npl_open_with_padding"),this._is_fullsize=!1},toggle:function(){t.methods.log("nplModal.fullsize.toggle()"),this.fullsize._is_fullsize?this.fullsize.exit():this.fullsize.enter(),e(window).trigger("resize")}},handle_keyboard_input:function(e){t.methods.is_open()&&27===e.which&&t.methods.close_modal()},is_open:function(){return this._is_open},log:function(e,i,n){t.debug&&(void 0===n&&(n=1),n>t.debug_level||(void 0===i?console.log("NPL Debug:",e):console.log("NPL Debug:",e,i)))},logging:{enable:function(){console.log("Enabling NextGen Pro Lightbox debugging"),t.debug=!0},disable:function(){console.log("Disabling NextGen Pro Lightbox debugging"),t.debug=!1},set_level:function(e){console.log("Setting NextGen Pro Lightbox debug level to "+e),t.level=parseInt(e)}},fetch_images:{gallery_image_cache:[],ajax_info:[],ajax_interval:null,ajax_delay:1400,is_cached:function(i,n){var a=!1;return e.each(this.gallery_image_cache[i],(function(e,t){n===t.image_id&&(a=!0)})),t.methods.log("nplModal.fetch_images.is_cached()",{gallery_id:i,image_id:n,gallery_cache:this.gallery_image_cache[i],found:a},4),a},fetch_images:function(i,n){t.methods.log("nplModal.fetch_images.fetch_images() beginning");var a=this;this.ajax_delay=t.methods.get_setting("ajax_delay",1400),void 0===this.gallery_image_cache[i]&&(this.gallery_image_cache[i]=[]);var o=t.methods.get_gallery_from_id(i);return null===o?this.fetch_non_ngg_images(i):this.gallery_image_cache[i].length===o.images_list_count?e("#npl_content").trigger("npl_images_ready",[i]):(e.each(o.images_list,(function(e,t){a.is_cached(i,t.image_id)||a.gallery_image_cache[i].push(t)})),this.gallery_image_cache[i].length===o.images_list_count?e("#npl_content").trigger("npl_images_ready",[i]):this.gallery_image_cache[i].length<o.images_list_count?this.fetch_images_from_ajax(i):void 0)},fetch_non_ngg_images:function(i){t.methods.log("nplModal.fetch_images.fetch_non_ngg_images() beginning",{gallery_id:i});var n=this;t.selector.each((function(){var a=e(this);if(a.hasClass("ngg-trigger"))return!0;if("!"!==i&&i!==a.data("nplmodal-gallery-id"))return!0;if(i!==t.methods.get_state().gallery_id)return!0;if("!"===t.methods.get_state().gallery_id&&a.data("nplmodal-gallery-id"))return!0;var o=e(this).find("img").first(),s={},l=/\.(jpeg|jpg|gif|png|bmp)$/i;if(s.image=void 0===a.data("fullsize")?a.attr("href"):a.data("fullsize"),void 0!==s.image&&!s.image.match(l)&&o.attr("srcset")){var r=parseSrcset(o.attr("srcset")),d=0;_.each(r,(function(e){void 0!==typeof e.w&&e.w>d&&(d=e.w,s.image=e.url)}))}if(s.image.match(l)||(s.image=o.attr("src")),s.image_id=void 0===a.data("image-id")?s.image:a.data("image-id"),n.is_cached(i,s.image_id))return!0;void 0!==a.data("thumb")?s.thumb=a.data("thumb"):"undefined"!==a.data("thumbnail")&&(s.thumb=a.data("thumbnail")),void 0!==a.data("title")?s.title=a.data("title"):void 0!==o.attr("title")?s.title=o.attr("title"):void 0!==a.siblings(".wp-caption-text").html()&&(s.title=a.siblings(".wp-caption-text").html()),void 0!==a.data("description")?s.description=a.data("description"):s.description=o.attr("alt"),n.gallery_image_cache[i].push(s)})),t.methods.log("nplModal.fetch_images.fetch_non_ngg_images() result",{result:n.gallery_image_cache[i]}),e("#npl_content").trigger("npl_images_ready",[i])},create_deferred_ajax:function(i,n,a){var o=this;return e.ajax({async:!0,url:t.options.ajax_url,method:"POST",data:{id:i,gallery:n,action:"pro_lightbox_load_images",lang:t.methods.get_setting("lang",null),page:a},dataType:"json",success:function(n){t.methods.log("nplModal.fetch_images.create_deferred_ajax() response",{response:n}),e.each(n,(function(e,t){o.is_cached(i,t.image_id)||o.gallery_image_cache[i].push(t)}))}})},fetch_images_from_ajax:function(n,a){if(t.methods.is_open()){t.methods.log("nplModal.fetch_images.fetch_images_from_ajax()",{gallery_id:n,image_id:a});var o=t.methods.get_gallery_from_id(n),s=e.extend({},o);delete s.images_list,delete s.display_settings;var l=[];for(i=0;i<=Math.ceil(s.images_list_count/t.methods.get_setting("localize_limit"));i++)l.push(t.methods.fetch_images.create_deferred_ajax(n,s,i));return e.when.apply(e,l).then((function(){e("#npl_content").trigger("npl_images_ready",[n])})),this.gallery_image_cache[n]}}},get_gallery_from_id:function(t){if(void 0===window.galleries)return null;var i=null;return e.each(window.galleries,(function(e,n){n.ID!==t&&n.ID!==parseInt(t)||(i=n)})),i},get_id_from_slug:function(t){var i=t;return void 0===window.galleries||e.each(window.galleries,(function(e,n){n.slug===t&&(i=n.ID)})),i},get_displayed_gallery_setting:function(e,i,n){var a="",o=this.get_gallery_from_id(e);return"1"===(a=o&&void 0!==o.display_settings[i]?o.display_settings[i]:n)&&(a=!0),"0"===a&&(a=!1),1===a&&(a=!0),0===a&&(a=!1),t.methods.log("nplModal.get_displayed_gallery_setting()",{gallery_id:e,name:i,result:a}),a},router:{routes:[],interval:null,listen:function(e){var t=this;e=e||"";clearInterval(this.interval),this.interval=setInterval((function(){e!==t.get_fragment()&&(e=t.get_fragment(),t.match(e))}),50)},get_fragment:function(e){var t=(e=e||window.location.href).match(/#(.*)$/);return(t?t[1]:"").toString().replace(/\/$/,"").replace(/^\//,"")},navigate:function(e,i){(i=i||!1)&&clearInterval(this.interval),t.methods.get_setting("enable_routing",!1)&&(e=e||"",window.location.href.match(/#(.*)$/),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+e,i&&this.router.listen(this.router.get_fragment()))},match:function(e){for(var i=e||this.get_fragment(),n=0;n<this.routes.length;n++){var a=i.match(this.routes[n].re);if(a)return a.shift(),this.routes[n].handler.apply(t.methods,a),this}},front_page_pushstate:function(i,n){if(!t.methods.get_setting("is_front_page")||void 0===i)return!1;if(void 0===window.galleries)return!1;t.methods.log("beginning nplModal.router.front_page_pushstate()",{gallery_id:i,image_id:n});var a="",o=i;return e.each(galleries,(function(e,t){t.ID===i&&void 0!==t.wordpress_page_root&&(a=t.wordpress_page_root,t.slug&&(o=t.slug))})),a+="#"+this.get_fragment(t.methods.get_setting("router_slug")+"/"+o+"/"+n),history.pushState?(history.pushState({},document.title,a),!0):(window.location=a,!1)}}}};this.core=t};e.nplModal=function(e){function i(e,t){for(var i=t.split(".");i.length;)e=e[i.shift()];return e}if(void 0===e)return t.core.init.apply(t,{});if("object"==typeof e)return t.core.init.apply(t,e);var n=i(t.core.methods,e);if(n)return n.apply(t.core.methods,Array.prototype.slice.call(arguments,1));console.error("Method "+e+" does not exist on jQuery.nplModal")}}(jQuery),jQuery(document).ready((function(e){e.nplModal()}));